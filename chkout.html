<!DOCTYPE html>
<html lang="en">
<head>


  <meta charset="UTF-8" />
<meta name="viewport" content="width=1024, maximum-scale=1.0, user-scalable=no">

  <title>Checkout - Signature Scents</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #fef9f2; margin: 0; padding: 0; color: #4a4a4a; }
    header { background: #6a4e42; color: white; padding: 1.5rem; text-align: center; font-size: 1.5rem; }
    .main-content { display: flex; justify-content: center; gap: 2rem; padding: 2rem; flex-wrap: wrap; }
    .checkout-container { background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 6px 14px rgba(0,0,0,0.08); width: 360px; }

    .upsell-container { width: 260px; }
    .summary-box { background: #fff6e9; padding: 1rem; border-radius: 10px; margin-top: 1.5rem; width: 240px; }
    .sample-card { background: white; border: 1px solid #ddd; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem; box-shadow: 0 3px 8px rgba(0,0,0,0.05); text-align: center; }
    .sample-card img { width: 80px; height: 80px; object-fit: cover; margin-bottom: 0.5rem; border-radius: 8px; background: #eee; }
    label { display: block; margin: 1rem 0 0.5rem; }
    input, select { width: 100%; padding: 0.6rem; margin-bottom: 1rem; border: 1px solid #ccc; border-radius: 8px; background: #fffdfa; }
    .inline-group { display: flex; gap: 1rem; }
    .inline-group > div { flex: 1; }
    .checkout-btn { width: 100%; padding: 0.6rem; background: #6a4e42; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; margin-top: 1rem; }
    .checkout-btn:hover { background: #5c4036; }
    .toggle-btn { background: #c0a080; color: white; border: none; padding: 0.4rem 0.9rem; border-radius: 6px; cursor: pointer; margin-bottom: 1rem; font-size: 0.9rem; }
    .back-btn { background: #f0e3d0; color: #5c4036; border: none; border-radius: 8px; padding: 0.4rem 0.8rem; cursor: pointer; font-size: 0.9rem; }
    .total-box { margin-top: 1.5rem; padding: 1rem; background: #fff6e9; border-radius: 10px; font-weight: bold; text-align: center; font-size: 1.1rem; 

}
  </style>
</head>
<body>
  <header>Checkout</header>
  <div class="main-content">
    <div class="checkout-container">
      <button class="back-btn" onclick="history.back()">‚Üê Back</button>
 <form id="checkout-form">
        <label for="fullname">Full Name:</label>
        <input type="text" id="fullname" required>
        <label for="street">Street Address:</label>
        <input type="text" id="street" required>
	<label for="email">Email Address:</label>
	<input type="email" id="email" name="email" required>
<input type="hidden" name="name" id="hidden-name">
<input type="hidden" name="email" id="hidden-email">
<input type="hidden" name="order" id="hidden-order">
<input type="hidden" name="total" id="hidden-total">

<label for="phone">Phone Number:</label>
<div style="display: flex; gap: 0.5rem;">
  <select id="area-code" name="area-code" style="width: 80px;" required>
    <option value="+1">+1 (US)</option>
  </select>
  <input type="tel" id="phone" name="phone" placeholder="Phone Number" required>
</div>


      <div class="inline-group">
  <div>
    <label for="city">City:</label>
    <input type="text" id="city" maxlength="32" required>
  </div>


  <div>
    <label for="state">State:</label>
    <select id="state" required>
      <option value="">--</option>
      <option>AL</option><option>AK</option><option>AZ</option><option>AR</option><option>CA</option>
      <option>CO</option><option>CT</option><option>DE</option><option>FL</option><option>GA</option>
      <option>HI</option><option>ID</option><option>IL</option><option>IN</option><option>IA</option>
      <option>KS</option><option>KY</option><option>LA</option><option>ME</option><option>MD</option>
      <option>MA</option><option>MI</option><option>MN</option><option>MS</option><option>MO</option>
      <option>MT</option><option>NE</option><option>NV</option><option>NH</option><option>NJ</option>
      <option>NM</option><option>NY</option><option>NC</option><option>ND</option><option>OH</option>
      <option>OK</option><option>OR</option><option>PA</option><option>RI</option><option>SC</option>
      <option>SD</option><option>TN</option><option>TX</option><option>UT</option><option>VT</option>
      <option>VA</option><option>WA</option><option>WV</option><option>WI</option><option>WY</option>
    </select>
  </div>
  <div>
    <label for="zip">ZIP Code:</label>
    <input type="text" id="zip" maxlength="10" required>
  </div>
</div>
<label for="country">Country:</label>
<input type="text" id="country" required placeholder="United States">
<label>
  <input type="checkbox" id="pobox"> This is a PO Box
</label>


        <label for="card">Credit Card Number:</label>
    <input type="password" id="card" maxlength="16" inputmode="numeric" pattern="\d*" required>
        <label>Expiration Date:</label>
        <div class="inline-group">
          <div><select id="exp-month" required><option value="">MM</option>
<option>01</option><option>02</option><option>03</option><option>04</option><option>05</option><option>06</option><option>07</option><option>08</option><option>09</option><option>10</option><option>11</option><option>12</option></select></div>
          <div><select id="exp-year" required></select></div>
        </div>
    <label for="cvc">CVC:</label>
       <input type="password" id="cvc" maxlength="3" inputmode="numeric" pattern="\d{3}" required>
        <button type="button" class="toggle-btn" onclick="toggleVisibility()">Show/Hide Payment Info</button>
<div style="margin-top: 1rem;">
  </div>


<div style="margin-top: 1rem;">
  <input type="checkbox" id="terms-checkbox" required>
  <label for="terms-checkbox">I accept the <a href="terms.html" target="_blank">Terms and Conditions</a></label>
</div>
      <button type="button" class="checkout-btn" onclick="sendEmail(event)">Complete Purchase</button>
       <div class="total-box">Total: $<span id="total">0.00</span></div>










      </form>
    </div>

    <div class="upsell-container">
      <div id="upsells"></div>
      <div class="summary-box" id="summary-box"></div>
    </div>
  </div>




  <script>

    const cart = JSON.parse(localStorage.getItem("cart")) || {};
    const upsellPrice = 0.99;
    const yearSelect = document.getElementById('exp-year');
    for (let y = new Date().getFullYear(); y <= 2035; y++) {
      const opt = document.createElement(\"option\");
      opt.textContent = y;
      yearSelect.appendChild(opt);
    }
    function toggleVisibility() {
      ['card', 'cvc'].forEach(id => {
        const input = document.getElementById(id);
        input.type = input.type === 'password' ? 'text' : 'password';
      });
    }
    function updateTotal() {
      let total = 0;
      Object.values(cart).forEach(item => {
        total += item.price * item.qty;
      });
      document.querySelectorAll('.sample-option').forEach(cb => {
        if (cb.checked) total += upsellPrice;
      });
      document.getElementById(\"total\").textContent = total.toFixed(2);
    }
    const summaryBox = document.getElementById(\"summary-box\");
    for (let item in cart) {
      const p = document.createElement(\"p\");
      p.textContent = `${item} x ${cart[item].qty}`;
      summaryBox.appendChild(p);
    }
    const upsellContainer = document.getElementById(\"upsells\");
    for (let item in cart) {
      for (let other in cart) {
        if (other !== item) {
          const card = document.createElement(\"div\");
          card.className = \"sample-card\";
          card.innerHTML = `
            <img src=\"#\" alt=\"Sample bottle\" />
            <h4>${other} Sample</h4>
            <p>0.5 oz sample ‚Äî $${upsellPrice.toFixed(2)}</p>
            <label><input type=\"checkbox\" class=\"sample-option\" onchange=\"updateTotal()\"> Add to Cart</label>
          `;
          upsellContainer.appendChild(card);
        }
        break;
      }
      break;
    }
    updateTotal();
  </script>




<script>
  const upsellPrice = 0.99;

  const products = {
    "Midnight Ember": 119.99,
    "Urban Spice": 89.99
  };

  const cart = JSON.parse(localStorage.getItem("cart")) || {};
  const upsellContainer = document.getElementById("upsells");
  const summaryBox = document.getElementById("summary-box");
  const totalDisplay = document.getElementById("total");

  function renderCartSummary() {
  summaryBox.innerHTML = "";
  let subtotal = 0;

  for (let item in cart) {
    const qty = parseInt(cart[item].qty);
    const price = parseFloat(cart[item].price);

    if (!isNaN(qty) && qty > 0 && !isNaN(price)) {
      subtotal += qty * price;
      const p = document.createElement("p");
      p.textContent = `${item} x ${qty} - $${(qty * price).toFixed(2)}`;
      summaryBox.appendChild(p);
    }
  }

  // üîª Add this block to show the discount message
  if (subtotal > 150) {
    const discountMsg = document.createElement("p");
    discountMsg.style.color = "green";
    discountMsg.textContent = `35% discount applied: -$${(subtotal * 0.35).toFixed(2)}`;
    summaryBox.appendChild(discountMsg);
  }
if (subtotal > 150) {
  const discountBanner = document.createElement("div");
  discountBanner.style.backgroundColor = "#e0ffe0";
  discountBanner.style.border = "2px solid green";
  discountBanner.style.color = "#2e7d32";
  discountBanner.style.padding = "10px";
  discountBanner.style.marginTop = "10px";
  discountBanner.style.borderRadius = "8px";
  discountBanner.style.fontWeight = "bold";
  discountBanner.textContent = `üéâ 35% discount applied: -$${(subtotal * 0.35).toFixed(2)}`;
  summaryBox.appendChild(discountBanner);
}

  updateTotal(subtotal); // Keep this at the end
}




  function updateTotal(subtotal) {
  let discount = 0;
  if (subtotal > 150) {
    discount = subtotal * 0.35; // 35% discount



















  }





  let total = subtotal - discount;

  // Add upsells
  document.querySelectorAll('.sample-option').forEach(cb => {
    if (cb.checked) total += upsellPrice;
  });

  totalDisplay.textContent = total.toFixed(2);
}


  function generateUpsells() {
    const selectedItems = Object.keys(cart);
    const allProducts = Object.keys(products);

    const upsellNames = allProducts.filter(p => !selectedItems.includes(p));
    upsellContainer.innerHTML = "";

    upsellNames.forEach(name => {
      const card = document.createElement("div");
      card.className = "sample-card";
      card.innerHTML = `
       
        <h4>${name} Sample</h4>
        <p>0.5 oz sample ‚Äî $${upsellPrice.toFixed(2)}</p>
        <label><input type="checkbox" class="sample-option" onchange="recalculate()"> Add to Cart</label>
      `;
      upsellContainer.appendChild(card);
    });
  }



  function recalculate() {
    let subtotal = 0;
    for (let item in cart) {
      subtotal += cart[item].qty * cart[item].price;
    }
    updateTotal(subtotal);
  }



  function toggleVisibility() {
    ['card', 'cvc'].forEach(id => {
      const input = document.getElementById(id);
      input.type = input.type === 'password' ? 'text' : 'password';
    });
  }

  // Fill expiration year
  const yearSelect = document.getElementById('exp-year');
  for (let y = new Date().getFullYear(); y <= 2035; y++) {
    const opt = document.createElement("option");
    opt.textContent = y;
    yearSelect.appendChild(opt);
  }

  generateUpsells();
  renderCartSummary();
</script>



<script>
  function submitOrder() {
    const termsAccepted = document.getElementById("terms-checkbox").checked;
    if (!termsAccepted) {
      alert("You must accept the Terms and Conditions to complete your purchase.");
      return false;
    }

    const confirmationNumber = Math.floor(Math.random() * 1000000000);
    localStorage.setItem("confirmationNumber", confirmationNumber);
    window.location.href = "thankyou.html";
    return false;
  }
</script>



<!-- EmailJS SDK v4 -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  emailjs.init({
    publicKey: "JZyxBW7fgfjXdzc8a", // Replace with your actual public key
    blockHeadless: true
  });

  function sendEmail(event) {
    event.preventDefault();

    const name = document.getElementById("fullname").value;
    const email = document.getElementById("email").value;
    const cart = JSON.parse(localStorage.getItem("cart")) || {};
    const total = document.getElementById("total").innerText;
    const confirmation = Math.floor(Math.random() * 1000000000);

    let orderDetails = "";
    for (let item in cart) {
      orderDetails += `${item} x ${cart[item].qty} - $${(cart[item].qty * cart[item].price).toFixed(2)}\n`;
    }

    // Validate Terms checkbox
    if (!document.getElementById("terms-checkbox").checked) {
      alert("You must accept the Terms and Conditions to complete your purchase.");
      return;
    }

    // Send Email via EmailJS
    emailjs.send("service_02aotpn", "template_sr96bdb", {
      name: name,
      email: email,
      order_details: orderDetails,
      total: total,
      confirmation_number: confirmation
    })
    .then(() => {
      localStorage.clear();
      window.location.href = "thankyou.html?confirmation=" + confirmation;
    })
    .catch((error) => {
      console.error("EmailJS error:", error);
      alert("There was an error sending your confirmation.");
    });
  }
</script>




</body>
</html>

